% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/otel.R
\name{is_otel_tracing}
\alias{is_otel_tracing}
\alias{create_ospan}
\alias{end_ospan}
\alias{with_ospan_async}
\alias{with_otel_span_async}
\title{\ifelse{html}{\href{https://lifecycle.r-lib.org/articles/stages.html#experimental}{\figure{lifecycle-experimental.svg}{options: alt='[Experimental]'}}}{\strong{[Experimental]}} OpenTelemetry integration}
\usage{
is_otel_tracing()

create_ospan(name, ..., attributes = NULL)

end_ospan(span)

with_ospan_async(name, expr, ..., attributes = NULL)

with_otel_span_async(span, expr, ..., auto_end_span = FALSE)
}
\arguments{
\item{name}{Character string. The name of the span.}

\item{...}{Additional arguments passed to \code{\link[otel:start_span]{otel::start_span()}}.}

\item{attributes}{Attributes passed through \code{\link[otel:as_attributes]{otel::as_attributes()}} (when
not \code{NULL})

For \code{with_otel_span_async()}, they must be empty.}

\item{expr}{An expression to evaluate within the span context.}

\item{auto_end_span}{Logical, [\code{FALSE}]; If \code{TRUE}, the span will
be ended either when the function exits (for synchronous operations) or when
a returned promise completes (for asynchronous operations).}
}
\description{
\pkg{otel} provides tools for integrating with OpenTelemetry, a framework for
observability and tracing in distributed systems.

These methods are intended to enhance the framework to be used with the
\pkg{promises} package, not as a generic replacement.
}
\section{Functions}{
\itemize{
\item \code{is_otel_tracing()}: \ifelse{html}{\href{https://lifecycle.r-lib.org/articles/stages.html#experimental}{\figure{lifecycle-experimental.svg}{options: alt='[Experimental]'}}}{\strong{[Experimental]}}

Check if OpenTelemetry tracing is enabled

\item \code{create_ospan()}: \ifelse{html}{\href{https://lifecycle.r-lib.org/articles/stages.html#experimental}{\figure{lifecycle-experimental.svg}{options: alt='[Experimental]'}}}{\strong{[Experimental]}}

Creates an OpenTelemetry span for discontiguous operations where you need
manual control over when the span ends.

Note, the created span is not activated. Please use \code{\link[=with_ospan_async]{with_ospan_async()}} to
activate it for the supplied expression.

Returns an \pkg{otel} span object.

\item \code{end_ospan()}: \ifelse{html}{\href{https://lifecycle.r-lib.org/articles/stages.html#experimental}{\figure{lifecycle-experimental.svg}{options: alt='[Experimental]'}}}{\strong{[Experimental]}}

Ends an created OpenTelemetry span for discontiguous operations.

\item \code{with_ospan_async()}: \ifelse{html}{\href{https://lifecycle.r-lib.org/articles/stages.html#experimental}{\figure{lifecycle-experimental.svg}{options: alt='[Experimental]'}}}{\strong{[Experimental]}}

Creates an OpenTelemetry span, executes the given expression within it, and ends the span.

This function is designed to handle both synchronous and asynchronous
(promise-based) operations. For promises, the span is automatically ended
when the promise resolves or rejects.

Returns the result of evaluating \code{expr}. If \code{expr} returns a promise,
the span will be automatically ended when the promise completes.

This function differs from synchronous otel span operations in that it
installs a promise domain and properly handles asynchronous operations. In
addition, the internal span will be ended either when the function exits (for
synchronous operations) or when a returned promise completes (for
asynchronous operations).

\item \code{with_otel_span_async()}: \ifelse{html}{\href{https://lifecycle.r-lib.org/articles/stages.html#experimental}{\figure{lifecycle-experimental.svg}{options: alt='[Experimental]'}}}{\strong{[Experimental]}}

Executes an expression within the context of an active OpenTelemetry span.

Adds an "Active OpenTelemetry promise domain" to the expression evaluation.
This domain activates the span on restore.

If \code{auto_end_span = TRUE}, the \code{span} will be ended either when the function
exits (for synchronous operations) or when a returned promise completes (for
asynchronous operations).

}}
\examples{
\dontrun{
# Synchronous operation
result <- with_ospan_async("my_operation", {
  # ... do some work ...
  42
})

# Asynchronous operation
p <- with_ospan_async("async_operation", {
  # ... return a promise ...
  some_async_function()
})
}
\dontrun{
# Start a span for discontiguous work (uncommon; use with caution)
spn <- create_ospan("my_operation")
with_otel_span_async(spn, {
  # ... do some work ...
})
# ...
# End span when ready
end_ospan(spn)
}

}
\keyword{internal}
